---
import Layout from '../layouts/Layout.astro'
import { TEAM_CONFIG, SOCIAL_DATA, EVENT_DATA } from '../config'
import { Picture } from 'astro:assets'
import teamHero from '../assets/team/hero.webp'
import CTASection from '../components/cta/CTASection.astro'

const team = TEAM_CONFIG

const openRoles = [
    {
        emoji: 'üéØ',
        title: 'Responsable Communication',
        description: 'Pour faire conna√Ætre notre r√©volution (et nos jeux de mots douteux)',
        skills: ['Marketing digital', 'Storytelling', 'R√©sistance aux bad jokes'],
        commitment: '2-3h/semaine',
    },
    {
        emoji: 'üé®',
        title: 'UX/UI Designer',
        description: 'Pour que notre site soit aussi beau que notre concept',
        skills: ['Figma/Sketch', 'Design System', 'Patience avec les devs'],
        commitment: 'Flexible',
    },
    {
        emoji: 'ü§ù',
        title: 'Community Manager',
        description: 'Pour animer notre communaut√© avec style et humour',
        skills: ['Social Media', 'Cr√©ativit√©', 'Memes de qualit√©'],
        commitment: '1-2h/jour',
    },
    {
        emoji: 'üíª',
        title: 'D√©veloppeur¬∑se',
        description: "Pour automatiser tout ce qui peut l'√™tre (on est des devs, apr√®s tout)",
        skills: ['React/Astro', 'Node.js', 'Caf√©++'],
        commitment: 'Selon motivation',
    },
]
const AVATAR_SIZE_PX = 160

// Build minimal list and preserve input order; support both new (name, linkedin_url, image_url) and legacy shapes
const members = Array.isArray(team)
    ? team
          .map((m) => ({
              name: m?.name ?? '',
              linkedin_url:
                  m?.linkedin_url ??
                  (m as any)?.socials?.find?.((s: any) => s?.name?.toLowerCase?.() === 'linkedin')?.link ??
                  null,
              image_url: m?.image_url ?? (m as any)?.photoUrl ?? null,
          }))
          .filter((m) => !!m.name && !!m.linkedin_url)
    : []
---

<Layout
    title={`L'√©quipe ${EVENT_DATA.event.name}`}
    description={`D√©couvrez les fous qui r√©volutionnent la tech ${EVENT_DATA.event.location.city.toLowerCase()}aise`}>
    <!-- Page Header with Hero Background -->
    <section class="relative h-[60vh] min-h-[500px] flex items-center justify-center overflow-hidden">
        <!-- Background Image -->
        <div class="absolute inset-0 z-0">
            <Picture
                src={teamHero}
                alt="√âquipe Tech'Work"
                class="w-full h-full object-cover object-top opacity-75"
                loading="eager"
                widths={[640, 768, 1024, 1280, 1920]}
                sizes="100vw"
            />
            <!-- Overlay -->
            <div class="absolute inset-0 bg-gradient-to-br from-black/60 via-black/50 to-black/40"></div>
        </div>

        <!-- Content -->
        <div class="relative z-10 max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="scroll-animate">
                <div
                    class="inline-flex items-center px-4 py-2 bg-white/20 backdrop-blur-sm border border-white/20 text-white rounded-full text-sm font-semibold mb-6">
                    <span class="mr-2 animate-bounce-gentle">üë•</span>
                    L'√©quipe
                </div>
                <h1 class="text-3xl sm:text-4xl lg:text-5xl font-black text-white mb-6">
                    Les <span class="text-gradient">architectes</span> de la r√©volution
                </h1>
                <p class="text-lg sm:text-xl text-gray-200 max-w-3xl mx-auto">
                    Deux d√©veloppeurs, une vision : cr√©er l'√©v√©nement tech qu'on aurait voulu avoir ‚Äî avec un amour
                    d√©raisonnable pour les lamas.
                </p>
            </div>
        </div>

        <!-- Scroll indicator -->
        <div class="absolute bottom-6 left-1/2 transform -translate-x-1/2 z-10">
            <div class="animate-bounce">
                <svg class="w-5 h-5 text-white/80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"
                    ></path>
                </svg>
            </div>
        </div>
    </section>

    <!-- Origin Story Section -->
    <section class="py-16 sm:py-20 lg:py-24 bg-gray-900 text-white relative overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-r from-primary-900/50 to-secondary-900/50"></div>
        <CTASection
            title="On se voit sur place ?"
            description="Passe dire bonjour √† l'√©quipe¬†: talks, ateliers, bonne ambiance."
            placement="content-team-early"
        />
        <div class="relative z-10 max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 scroll-animate">
                <div
                    class="inline-flex items-center px-4 py-2 bg-green-100 text-green-700 rounded-full text-sm font-semibold mb-6">
                    <span class="mr-2">üí°</span>
                    L'origine story
                </div>
                <h2 class="text-3xl sm:text-4xl lg:text-5xl font-black text-white mb-6">Comment tout a commenc√©</h2>
            </div>

            <div
                class="bg-gradient-to-r from-gray-50 to-white rounded-2xl p-6 sm:p-8 border border-gray-200 hover-lift scroll-animate-scale">
                <div class="space-y-6">
                    <div class="flex items-start space-x-4">
                        <div class="text-4xl">üç∑</div>
                        <div>
                            <h3 class="text-xl font-bold text-gray-900 mb-2">Chapitre 1 : Tech & Wine</h3>
                            <p class="text-gray-600 leading-relaxed">
                                Au d√©but, on organisait Tech & Wine. Super concept, tout le monde adorait ! Mais on
                                s'est rendu compte d'un petit souci : comment faire "Tech & Bi√®re" ? "Tech & Mojito" ?
                                "Tech & Jus de fruits" pour les non-buveurs ? ü§î
                            </p>
                        </div>
                    </div>

                    <div class="border-l-4 border-yellow-400 pl-4 bg-yellow-50 rounded-r-lg p-4">
                        <p class="text-yellow-800 italic">
                            <strong>Le probl√®me :</strong> Un th√®me sympa mais difficile √† d√©cliner. Et puis, organiser √ßa
                            le soir apr√®s une journ√©e de travail... nos cerveaux de devs n'√©taient plus tr√®s frais pour apprendre
                            ! üò¥
                        </p>
                    </div>

                    <div class="flex items-start space-x-4">
                        <div class="text-4xl">üí°</div>
                        <div>
                            <h3 class="text-xl font-bold text-gray-900 mb-2">Chapitre 2 : L'illumination</h3>
                            <p class="text-gray-600 leading-relaxed">
                                Et l√†, eureka ! Quel est le point commun entre tous les d√©veloppeurs ? Le travail ! On
                                passe plus de temps avec notre IDE qu'avec notre famille (ne le dites pas √† nos
                                conjoints ü§ê). Pourquoi ne pas c√©l√©brer √ßa ?
                            </p>
                        </div>
                    </div>

                    <div class="bg-gradient-to-r from-green-50 to-primary-50 rounded-lg p-4 border border-green-200">
                        <div class="flex items-center space-x-2 mb-2">
                            <span class="text-2xl">üöÄ</span>
                            <h4 class="text-lg font-bold text-gray-900">La solution : {EVENT_DATA.event.shortName}</h4>
                        </div>
                        <p class="text-gray-700">
                            Un √©v√©nement sur le <strong>temps de travail</strong>, avec un th√®me qui parle √† tous :
                            <strong>notre m√©tier</strong>. Reproductible √† l'infini, accessible √† tous, et fini les
                            excuses "j'ai pas pu venir, j'√©tais crev√©" ! üòé
                        </p>
                    </div>

                    <div class="text-center">
                        <div class="inline-flex items-center space-x-2 text-primary-600 font-semibold">
                            <span>Et voil√† comment {EVENT_DATA.event.shortName} est n√© !</span>
                            <span class="text-2xl animate-bounce-gentle">üéâ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Join Team Section (moved up) -->
    <section id="join-us" class="py-16 sm:py-20 lg:py-24 bg-white">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 scroll-animate">
                <div
                    class="inline-flex items-center px-4 py-2 bg-secondary-100 text-secondary-700 rounded-full text-sm font-semibold mb-6">
                    <span class="mr-2 animate-bounce-gentle">üöÄ</span>
                    Rejoignez-nous
                </div>
                <h2 class="text-3xl sm:text-4xl lg:text-5xl font-black text-gray-900 mb-6">
                    Participez √† la <span class="text-gradient">r√©volution</span>
                </h2>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                    On cherche des complices pour nous aider √† r√©volutionner l'√©v√©nementiel tech
                </p>
            </div>

            <div class="grid md:grid-cols-2 gap-6 lg:gap-8 stagger-children mb-16">
                {
                    openRoles.map((role, index) => (
                        <div
                            class="card hover-lift scroll-animate-scale group"
                            style={`animation-delay: ${index * 0.15}s`}>
                            <div class="p-6 relative overflow-hidden">
                                {/* Effet de brillance */}
                                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent transform -skew-x-12 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 pointer-events-none" />

                                <div class="relative z-10">
                                    <div class="flex items-center space-x-3 mb-4">
                                        <div class="text-3xl group-hover:animate-bounce-gentle">{role.emoji}</div>
                                        <h3 class="text-xl font-bold text-gray-900 group-hover:text-primary-600 transition-colors duration-300">
                                            {role.title}
                                        </h3>
                                    </div>

                                    <p class="text-gray-600 mb-4 leading-relaxed">{role.description}</p>

                                    <div class="space-y-3">
                                        <div>
                                            <span class="text-sm font-semibold text-primary-600">
                                                Skills recherch√©s:
                                            </span>
                                            <div class="flex flex-wrap gap-2 mt-2">
                                                {role.skills.map((skill) => (
                                                    <span class="px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-xs font-medium">
                                                        {skill}
                                                    </span>
                                                ))}
                                            </div>
                                        </div>

                                        <div class="flex items-center space-x-2 text-sm">
                                            <span class="text-secondary-600 font-semibold">‚è∞ Engagement:</span>
                                            <span class="text-gray-600">{role.commitment}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    ))
                }
            </div>

            <!-- Contact CTA -->
            <div class="text-center scroll-animate-scale">
                <div
                    class="bg-gradient-to-r from-primary-50 to-secondary-50 rounded-2xl p-8 border border-primary-100 hover-lift">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4">
                        Pr√™t¬∑e √† r√©volutionner la tech {EVENT_DATA.event.location.city.toLowerCase()}aise ? üöÄ
                    </h3>
                    <p class="text-lg text-gray-600 mb-6">
                        √âcrivez-nous et dites-nous comment vous voulez contribuer √† l'aventure
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center">
                        <a
                            href={`mailto:${SOCIAL_DATA.contact.team}`}
                            class="btn btn-primary text-lg px-8 py-4 hover-lift group"
                            aria-label="Rejoindre l'√©quipe (contact email)"
                            data-cta
                            data-placement="team-contact-primary">
                            <span class="mr-2 group-hover:animate-bounce-gentle" aria-hidden="true">üìß</span>
                            Rejoindre l'√©quipe
                        </a>
                        <a
                            href="https://discord.gg/techwork-lyon"
                            target="_blank"
                            rel="noopener noreferrer"
                            class="btn btn-secondary text-lg px-8 py-4 hover-lift group"
                            aria-label="Rejoindre la communaut√© Discord"
                            data-cta
                            data-placement="team-contact-discord">
                            <span class="mr-2 group-hover:animate-bounce-gentle" aria-hidden="true">üí¨</span>
                            Discord communaut√©
                        </a>
                    </div>
                    <p class="text-sm text-gray-500 mt-4 italic">(Oui, on a un vrai email de devs qui fonctionne)</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Team Members Section -->
    <section id="team-members" class="py-16 sm:py-20 lg:py-24 bg-white">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 scroll-animate">
                <h2 class="text-3xl sm:text-4xl font-black text-gray-900 mb-6">
                    Une √©quipe de <span class="text-gradient">passionn√©s</span>
                </h2>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto">
                    {EVENT_DATA.event.shortName}, c'est avant tout une aventure collective. D√©couvrez les personnes qui
                    donnent vie √† cette r√©volution tech !
                </p>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 lg:gap-8 stagger-children">
                {
                    members.map((member, index) => (
                        <div
                            class="card hover-lift scroll-animate-scale group p-6 flex flex-col items-center text-center"
                            style={`animation-delay: ${index * 0.2}s`}>
                            <a
                                href={member.linkedin_url}
                                target="_blank"
                                rel="noopener noreferrer nofollow"
                                aria-label={`Voir le profil LinkedIn de ${member.name}`}
                                class="focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 rounded-full inline-block">
                                {member.image_url && (
                                    <img
                                        src={member.image_url}
                                        alt={`Photo de ${member.name}`}
                                        class="rounded-full object-cover w-40 h-40"
                                        width={AVATAR_SIZE_PX}
                                        height={AVATAR_SIZE_PX}
                                        loading="lazy"
                                        decoding="async"
                                        onerror="this.style.display='none'; if (this.nextElementSibling) this.nextElementSibling.classList.remove('hidden')"
                                    />
                                )}
                                <span
                                    class={`${member.image_url ? 'hidden ' : ''}w-40 h-40 rounded-full bg-gray-100 text-gray-600 flex items-center justify-center text-3xl font-bold select-none`}
                                    aria-hidden="true">
                                    {member.name?.charAt(0)?.toUpperCase()}
                                </span>
                            </a>
                            <a
                                href={member.linkedin_url}
                                target="_blank"
                                rel="noopener noreferrer nofollow"
                                aria-label={`Voir le profil LinkedIn de ${member.name}`}
                                class="mt-4 text-lg font-semibold text-gray-900 hover:text-primary-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 rounded">
                                {member.name}
                            </a>
                        </div>
                    ))
                }
            </div>
        </div>
    </section>
</Layout>
