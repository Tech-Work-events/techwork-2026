---
import Layout from '../layouts/Layout.astro'
import { SOCIAL_DATA, EVENT_DATA } from '../config'
import { Picture } from 'astro:assets'
import teamHero from '../assets/team/hero.webp'
import CTASection from '../components/cta/CTASection.astro'

import { OPENPLANNER_URL } from 'astro:env/client'
import type { OpenPlannerType } from '../type'

const response = await fetch(OPENPLANNER_URL)
const openPlannerData: OpenPlannerType = await response.json()
const team = openPlannerData.team

const openRoles = [
    {
        emoji: 'üéØ',
        title: 'Responsable Communication',
        description: 'Pour faire conna√Ætre notre r√©volution (et nos jeux de mots douteux)',
        skills: ['Marketing digital', 'Storytelling', 'R√©sistance aux crachats de bugs'],
        commitment: "C'est toi qui choisis (Ola t'en voudra pas)",
    },
    {
        emoji: 'üé®',
        title: 'UX/UI Designer',
        description: "Pour que notre site soit aussi beau que le pelage d'un alpaga",
        skills: ['Figma/Sketch', 'Design System', 'Patience avec les devs'],
        commitment: "C'est toi qui choisis (Ola t'en voudra pas)",
    },
    {
        emoji: 'ü§ù',
        title: 'Community Manager',
        description: 'Pour animer notre communaut√© avec style et humour',
        skills: ['Social Media', 'Cr√©ativit√©', 'Memes de qualit√©'],
        commitment: "C'est toi qui choisis (Ola t'en voudra pas)",
    },
    {
        emoji: 'üíª',
        title: 'D√©veloppeur¬∑se',
        description: "Pour automatiser tout ce qui peut l'√™tre (on est des devs, apr√®s tout)",
        skills: ['React/Astro', 'Node.js', 'Caf√©++'],
        commitment: "C'est toi qui choisis (Ola t'en voudra pas)",
    },
]
const AVATAR_SIZE_PX = 160

// Build minimal list and preserve input order; support both new (name, linkedin_url, image_url) and legacy shapes
const members = Array.isArray(team)
    ? team
          .map((m) => ({
              name: m?.name ?? '',
              linkedin_url: m?.socials?.find?.((s: any) => s?.name?.toLowerCase?.() === 'linkedin')?.link ?? null,
              image_url: m?.photoUrl ?? null,
          }))
          .filter((m) => !!m.name && !!m.linkedin_url)
    : []
---

<Layout
    title={`L'√©quipe ${EVENT_DATA.event.name}`}
    description={`D√©couvrez l'√©quipe qui r√©volutionne la tech ${EVENT_DATA.event.location.city.toLowerCase()}aise`}>
    <!-- Page Header with Hero Background -->
    <section class="relative min-h-[80vh] min-h-[400px] flex items-center justify-center overflow-hidden py-24">
        <!-- Background Image -->
        <div class="absolute inset-0 z-0">
            <Picture
                src={teamHero}
                alt="√âquipe Tech'Work"
                class="w-full h-full object-cover object-top opacity-75"
                loading="eager"
                widths={[640, 768, 1024, 1280, 1920]}
                sizes="100vw"
            />
            <!-- Overlay -->
            <div class="absolute inset-0 bg-gradient-to-br from-black/60 via-black/50 to-black/40"></div>
        </div>

        <!-- Content -->
        <div class="relative z-10 max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="scroll-animate">
                <div
                    class="inline-flex items-center px-4 py-2 bg-white/20 backdrop-blur-sm border border-white/20 text-white rounded-full text-sm font-semibold mb-8">
                    <span class="mr-2 animate-bounce-gentle">ü¶ô</span>
                    L'√©quipe
                </div>
                <h1 class="text-3xl sm:text-4xl lg:text-5xl font-black text-white mb-8">
                    L'<span class="text-gradient">√âquipe</span> Fondatrice
                </h1>
                <p class="text-lg sm:text-xl text-gray-200 max-w-3xl mx-auto">
                    Une √©quipe de passionn√©s (et un lama) pour r√©volutionner l'√©v√©nementiel tech.
                </p>
            </div>
        </div>

        <!-- Scroll indicator -->
        <div class="absolute bottom-12 left-1/2 transform -translate-x-1/2 z-20">
            <div class="animate-bounce">
                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"
                    ></path>
                </svg>
            </div>
        </div>
    </section>

    <!-- Team Members Section (Moved UP) -->
    <section id="team-members" class="py-16 sm:py-20 lg:py-24 bg-white relative z-10 -mt-10 rounded-t-3xl">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 scroll-animate">
                <h2 class="text-3xl sm:text-4xl font-black text-gray-900 mb-6">
                    Les <span class="text-gradient">Gardiens</span> du Lama
                </h2>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto">
                    Ils codent, ils organisent, et ils nourrissent Ola. Voici les humains derri√®re le projet.
                </p>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 lg:gap-8 stagger-children">
                {
                    members.map((member, index) => (
                        <div
                            class="card hover-lift scroll-animate-scale group p-6 flex flex-col items-center text-center"
                            style={`animation-delay: ${index * 0.2}s`}>
                            <a
                                href={member.linkedin_url}
                                target="_blank"
                                rel="noopener noreferrer nofollow"
                                aria-label={`Voir le profil LinkedIn de ${member.name}`}
                                class="focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 rounded-full inline-block">
                                {member.image_url && (
                                    <img
                                        src={member.image_url}
                                        alt={`Photo de ${member.name}`}
                                        class="rounded-full object-cover w-40 h-40"
                                        width={AVATAR_SIZE_PX}
                                        height={AVATAR_SIZE_PX}
                                        loading="lazy"
                                        decoding="async"
                                        onerror="this.style.display='none'; if (this.nextElementSibling) this.nextElementSibling.classList.remove('hidden')"
                                    />
                                )}
                                <span
                                    class={`${member.image_url ? 'hidden ' : ''}w-40 h-40 rounded-full bg-gray-100 text-gray-600 flex items-center justify-center text-3xl font-bold select-none`}
                                    aria-hidden="true">
                                    {member.name?.charAt(0)?.toUpperCase()}
                                </span>
                            </a>
                            <a
                                href={member.linkedin_url}
                                target="_blank"
                                rel="noopener noreferrer nofollow"
                                aria-label={`Voir le profil LinkedIn de ${member.name}`}
                                class="mt-4 text-lg font-semibold text-gray-900 hover:text-primary-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 rounded">
                                {member.name}
                            </a>
                        </div>
                    ))
                }
            </div>
        </div>
    </section>

    <!-- Origin Story Section (Simplified & Moved Down) -->
    <section class="py-16 sm:py-20 lg:py-24 bg-gray-50 overflow-hidden">
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12 scroll-animate">
                <div
                    class="inline-flex items-center px-4 py-2 bg-primary-100 text-primary-700 rounded-full text-sm font-semibold mb-6">
                    <span class="mr-2">üìú</span>
                    La L√©gende
                </div>
                <h2 class="text-3xl sm:text-4xl font-black text-gray-900 mb-6">Comment on en est arriv√© l√† ?</h2>
            </div>

            <div class="relative">
                <!-- Timeline line -->
                <div class="absolute left-1/2 transform -translate-x-1/2 h-full w-1 bg-gray-200 hidden md:block"></div>

                <div class="space-y-12">
                    <!-- Step 1 -->
                    <div class="relative flex flex-col md:flex-row items-center justify-between scroll-animate-left">
                        <div
                            class="md:w-5/12 order-2 md:order-1 bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                            <h3 class="text-xl font-bold text-gray-900 mb-2">2023 : Les d√©buts Cloud Alpes</h3>
                            <p class="text-gray-600 text-sm">
                                Notre premier √©v√©nement, en petit comit√© mais 100% passion. C'√©tait top, mais tr√®s focus
                                Cloud & DevOps. On s'est vite dit qu'on voulait ouvrir les chakras √† toute la tech
                                (Data, IA, Craft, Agilit√©...) parce qu'au final, on bosse tous ensemble.
                            </p>
                        </div>
                        <div
                            class="absolute left-1/2 transform -translate-x-1/2 w-8 h-8 bg-primary-500 rounded-full border-4 border-white hidden md:flex items-center justify-center text-white font-bold z-10">
                            1
                        </div>
                        <div class="md:w-5/12 order-1 md:order-2 text-center md:text-left pl-8 hidden md:block">
                            <span class="text-4xl">üèîÔ∏è</span>
                        </div>
                    </div>

                    <!-- Step 2 -->
                    <div class="relative flex flex-col md:flex-row items-center justify-between scroll-animate-right">
                        <div class="md:w-5/12 order-1 md:order-1 text-center md:text-right pr-8 hidden md:block">
                            <span class="text-4xl">üç∑</span>
                        </div>
                        <div
                            class="absolute left-1/2 transform -translate-x-1/2 w-8 h-8 bg-secondary-500 rounded-full border-4 border-white hidden md:flex items-center justify-center text-white font-bold z-10">
                            2
                        </div>
                        <div
                            class="md:w-5/12 order-2 md:order-2 bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                            <h3 class="text-xl font-bold text-gray-900 mb-2">2024 : La suite Tech & Wine</h3>
                            <p class="text-gray-600 text-sm">
                                Direction le Ch√¢teau de Montchat ! Succ√®s total, networking incroyable avec des artisans
                                vignerons. Mais bon, un ch√¢teau √ßa co√ªte un bras, et le "Wine" freinait certains
                                sponsors (on les comprend). Il fallait √©voluer.
                            </p>
                        </div>
                    </div>

                    <!-- Step 3 -->
                    <div class="relative flex flex-col md:flex-row items-center justify-between scroll-animate-left">
                        <div
                            class="md:w-5/12 order-2 md:order-1 bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                            <h3 class="text-xl font-bold text-gray-900 mb-2">2025 : La pause r√©flexion</h3>
                            <p class="text-gray-600 text-sm">
                                Une ann√©e off pour repenser le concept. Autour d'un resto, Kevin lance : "Tech'Work !".
                                L'id√©e ? L'ambiance afterwork (partage, √©changes, networking) mais sur le temps de
                                travail tout en gardant les artisans locaux. Et pour le fun ? Un lama mascotte nomm√© Ola
                                (clin d'≈ìil √† O'lama).
                            </p>
                        </div>
                        <div
                            class="absolute left-1/2 transform -translate-x-1/2 w-8 h-8 bg-gray-700 rounded-full border-4 border-white hidden md:flex items-center justify-center text-white font-bold z-10">
                            3
                        </div>
                        <div class="md:w-5/12 order-1 md:order-2 text-center md:text-left pl-8 hidden md:block">
                            <span class="text-4xl">ü§î</span>
                        </div>
                    </div>

                    <!-- Step 4 -->
                    <div class="relative flex flex-col md:flex-row items-center justify-between scroll-animate-right">
                        <div class="md:w-5/12 order-1 md:order-1 text-center md:text-right pr-8 hidden md:block">
                            <span class="text-4xl animate-bounce-gentle">ü¶ô</span>
                        </div>
                        <div
                            class="absolute left-1/2 transform -translate-x-1/2 w-8 h-8 bg-primary-500 rounded-full border-4 border-white hidden md:flex items-center justify-center text-white font-bold z-10">
                            4
                        </div>
                        <div
                            class="md:w-5/12 order-2 md:order-2 bg-gradient-to-br from-primary-50 to-secondary-50 p-6 rounded-2xl shadow-sm border border-primary-100">
                            <h3 class="text-xl font-bold text-gray-900 mb-2">2026 : Tech'Work 1√®re √©dition</h3>
                            <p class="text-gray-700 text-sm font-medium">
                                C'est le grand lancement ! Un √©v√©nement pro, utile, inclusif, et d√©cal√©. Le bonheur. Ola
                                est pr√™t, l'√©quipe aussi. La r√©volution est en marche !
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="py-8 sm:py-12 bg-gray-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <p class="text-center text-base sm:text-lg text-gray-600 max-w-3xl mx-auto">
                Apr√®s ces quatre √©tapes marquantes, notre √©quipe a trouv√© sa voie‚ÄØ: allier technologie, convivialit√© et
                cr√©ativit√© autour d‚ÄôOla le lama, notre mascotte embl√©matique. Nous continuons d‚Äôinnover, d‚Äôaccueillir
                des artisans passionn√©s et d‚Äôoffrir une exp√©rience unique √† chaque √©dition. Rejoignez‚Äënous pour √©crire
                le prochain chapitre‚ÄØ!
            </p>
        </div>
    </section>

    <!-- Join Team Section -->
    <section id="join-us" class="py-16 sm:py-20 lg:py-24 bg-white">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 scroll-animate">
                <div
                    class="inline-flex items-center px-4 py-2 bg-secondary-100 text-secondary-700 rounded-full text-sm font-semibold mb-6">
                    <span class="mr-2 animate-bounce-gentle">ü¶ô</span>
                    Recrutement
                </div>
                <h2 class="text-3xl sm:text-4xl lg:text-5xl font-black text-gray-900 mb-6">
                    Rejoignez l'<span class="text-gradient">aventure</span>
                </h2>
                <p class="text-lg sm:text-xl text-gray-600 max-w-3xl mx-auto">
                    On cherche des lamas motiv√©s pour nous aider √† r√©volutionner l'√©v√©nementiel tech.
                </p>
            </div>

            <div class="grid md:grid-cols-2 gap-6 lg:gap-8 stagger-children mb-16">
                {
                    openRoles.map((role, index) => (
                        <div
                            class="card hover-lift scroll-animate-scale group"
                            style={`animation-delay: ${index * 0.15}s`}>
                            <div class="p-6 relative overflow-hidden">
                                {/* Effet de brillance */}
                                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent transform -skew-x-12 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 pointer-events-none" />

                                <div class="relative z-10">
                                    <div class="flex items-center space-x-3 mb-4">
                                        <div class="text-3xl group-hover:animate-bounce-gentle">{role.emoji}</div>
                                        <h3 class="text-xl font-bold text-gray-900 group-hover:text-primary-600 transition-colors duration-300">
                                            {role.title}
                                        </h3>
                                    </div>

                                    <p class="text-gray-600 mb-4 leading-relaxed">{role.description}</p>

                                    <div class="space-y-3">
                                        <div>
                                            <span class="text-sm font-semibold text-primary-600">
                                                Skills recherch√©s:
                                            </span>
                                            <div class="flex flex-wrap gap-2 mt-2">
                                                {role.skills.map((skill) => (
                                                    <span class="px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-xs font-medium">
                                                        {skill}
                                                    </span>
                                                ))}
                                            </div>
                                        </div>

                                        <div class="flex items-center space-x-2 text-sm">
                                            <span class="text-secondary-600 font-semibold">‚è∞ Engagement:</span>
                                            <span class="text-gray-600">{role.commitment}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    ))
                }
            </div>

            <!-- Contact CTA -->
            <div class="text-center scroll-animate-scale">
                <div
                    class="relative overflow-hidden bg-gradient-to-br from-primary-50 via-white to-secondary-50 rounded-3xl p-8 sm:p-12 border border-primary-100 shadow-lg hover:shadow-2xl transition-all duration-500 hover:scale-[1.01] group">
                    <!-- Decorative background elements -->
                    <div
                        class="absolute top-0 right-0 -mt-10 -mr-10 w-40 h-40 bg-primary-200 rounded-full blur-3xl opacity-20 group-hover:opacity-30 transition-opacity duration-500">
                    </div>
                    <div
                        class="absolute bottom-0 left-0 -mb-10 -ml-10 w-40 h-40 bg-secondary-200 rounded-full blur-3xl opacity-20 group-hover:opacity-30 transition-opacity duration-500">
                    </div>

                    <div class="relative z-10">
                        <h3 class="text-3xl sm:text-4xl font-black text-gray-900 mb-6">
                            Pr√™t¬∑e √† rejoindre <span
                                class="text-gradient bg-clip-text text-transparent bg-gradient-to-r from-primary-600 to-secondary-600"
                                >l'aventure</span
                            > ? ü¶ô
                        </h3>
                        <p class="text-lg sm:text-xl text-gray-600 mb-8 max-w-2xl mx-auto leading-relaxed">
                            √âcrivez-nous et dites-nous quel est votre super-pouvoir. On a h√¢te de vous rencontrer !
                        </p>

                        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                            <a
                                href={`mailto:${SOCIAL_DATA.contact.team}`}
                                class="btn btn-primary text-base sm:text-lg px-6 sm:px-8 py-3 sm:py-4 rounded-full shadow-md hover:shadow-lg hover:-translate-y-1 transition-all duration-300 flex items-center group/btn w-full sm:w-auto justify-center"
                                aria-label="Rejoindre l'√©quipe (contact email)"
                                data-cta
                                data-placement="team-contact-primary">
                                <span class="mr-3 text-2xl group-hover/btn:animate-bounce-gentle" aria-hidden="true"
                                    >üìß</span
                                >
                                <span class="font-bold">Rejoindre l'√©quipe</span>
                            </a>
                            <a
                                href="https://chat.whatsapp.com/KpQOCcO16yC3nCxvaKcNsc"
                                target="_blank"
                                rel="noopener noreferrer"
                                class="btn btn-secondary text-base sm:text-lg px-6 sm:px-8 py-3 sm:py-4 rounded-full shadow-md hover:shadow-lg hover:-translate-y-1 transition-all duration-300 flex items-center group/btn w-full sm:w-auto justify-center"
                                aria-label="Rejoindre la communaut√© WhatsApp"
                                data-cta
                                data-placement="team-contact-whatsapp">
                                <span class="mr-3 text-2xl group-hover/btn:animate-bounce-gentle" aria-hidden="true"
                                    >üí¨</span
                                >
                                <span class="font-bold">WhatsApp communaut√©</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <CTASection
        title="On se voit sur place ?"
        description="Passe dire bonjour √† l'√©quipe et √† Ola : talks, ateliers, bonne ambiance."
        placement="content-team-early"
    />
</Layout>
