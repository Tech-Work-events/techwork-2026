---
import { getCollection } from 'astro:content'
import Layout from '../../layouts/Layout.astro'

import CTASection from '../../components/cta/CTASection.astro'

const posts = await getCollection('blog')

posts.sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
---

<Layout title="Blog | Tech'Work Lyon">
    <!-- Hero Section -->
    <section class="pt-24 sm:pt-28 lg:pt-32 pb-12 sm:pb-16 lg:pb-20 bg-gradient-to-br from-gray-50 to-white">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div
                class="inline-flex items-center px-4 py-2 bg-primary-100 text-primary-700 rounded-full text-sm font-semibold mb-6 animate-scale-in hover-lift">
                <span class="mr-2 animate-bounce-gentle">üìù</span>
                Blog Tech'Work
            </div>
            <h1 class="text-3xl sm:text-4xl md:text-5xl font-black text-gray-900 mb-6 scroll-animate">
                Actualit√©s et
                <span class="text-gradient animate-gradient">coulisses</span>
            </h1>
            <p class="text-lg sm:text-xl text-gray-600 max-w-2xl mx-auto scroll-animate">
                D√©couvrez les actualit√©s de Tech'Work Lyon, nos r√©flexions (lama friendly) sur l'√©cosyst√®me tech
                lyonnais et les coulisses de l'organisation (avec ou sans laine).
            </p>
        </div>
    </section>

    <!-- Articles Section -->
    <section class="py-12 sm:py-16 lg:py-20 bg-white">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            {
                posts.length === 0 ? (
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">üìù</div>
                        <h2 class="text-2xl font-bold text-gray-900 mb-4">Aucun article pour le moment</h2>
                        <p class="text-gray-600">Les premiers articles arrivent bient√¥t ! Restez connect√©s.</p>
                    </div>
                ) : (
                    <div class="space-y-8 stagger-children">
                        {posts.map((post, index) => (
                            <article
                                class="card hover-lift scroll-animate-scale group"
                                style={`animation-delay: ${index * 0.1}s`}>
                                <div class="p-6 sm:p-8">
                                    <div class="flex items-center justify-between mb-4">
                                        <time class="text-sm text-gray-500 bg-gray-100 px-3 py-1 rounded-full">
                                            {post.data.date.toLocaleString('fr-FR', {
                                                day: 'numeric',
                                                month: 'long',
                                                year: 'numeric',
                                            })}
                                        </time>
                                        <div class="text-2xl group-hover:animate-bounce-gentle transition-all duration-300">
                                            üìù
                                        </div>
                                    </div>

                                    <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 group-hover:text-primary-600 transition-colors duration-300">
                                        <a href={`/blog/${post.id}`} class="hover:no-underline">
                                            {post.data.title}
                                        </a>
                                    </h2>

                                    {post.data.description && (
                                        <p class="text-gray-600 mb-4 leading-relaxed">{post.data.description}</p>
                                    )}

                                    <div class="flex items-center justify-between">
                                        <a
                                            href={`/blog/${post.id}`}
                                            class="btn btn-secondary text-sm px-4 py-2 hover-lift group/btn">
                                            <span class="mr-2 group-hover/btn:animate-bounce-gentle">üëÄ</span>
                                            Lire l'article
                                        </a>
                                    </div>
                                </div>
                            </article>
                        ))}
                    </div>
                )
            }

            <CTASection
                title="On continue la lecture en vrai ?"
                description="Le blog c'est cool, mais sur place c'est mieux. Reserve ta place."
                placement="content-blog-index"
            />
        </div>
    </section>
</Layout>
